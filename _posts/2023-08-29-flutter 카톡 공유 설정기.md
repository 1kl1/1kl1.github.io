---
title: flutter 카카오톡으로 공유하기(Kakao flutter sdk 사용)
date: 2023-08-30 01:34:00
categories: [개발, flutter]
tags: [개발, flutter, 카카오톡 공유]
---
 flutter로 앱을 개발하다보면 공유기능이 필요해질 때가 있습니다. (친구초대 이벤트, 정보 공유 등..)  
사실 개인적으로 한국에서 카카오톡만한 전국민이 쓰는 메신저 어플리케이션이 없고, 단톡방은 그 어느것보다도 효과적인 마케팅 채널이라고 생각하고 있습니다.  
게다가, 카톡에서는 다음과 같이 예쁘게? 공유기능을 제공해주고 있습니다.
  
<img width=80% src=https://developers.kakao.com/docs/latest/ko/assets/style/images/message/message-type.png>  
  
원래는 카카오톡 공유 기능을 구현하고 설정하는 방법에 대해 알려주는 튜토리얼 형식의 글을 쓰려고 했으나..  
기존에 너무 잘 써주신 블로그 글이 많고, 카카오톡이 문서화를 워낙 잘 해주어서 주제를 해당 기능을 설정하며 겪을 수 있는 문제에 대해 troubleshooting헀던 과정을 적으려 합니다.  
혹시 제가 잘못 알고 있는 내용이 있다면 댓글에 남겨주시면 감사하겠습니다!!  
# 카카오톡 딥 링크의 개념
처음에 카카오톡 공유를 도입하겠다! 생각하고 도입하면서, 기존의 내가 갖고있던 생각과 다른점이 있었습니다.
카카오톡 공유가 단순히 '링크'를 전달하는 게 아니라는 점입니다.  
main>AndroidManifset.xml 파일을 보면 application안에 다음과 같이 정의해야 합니다.
```xml
<intent-filter>
    <action android:name="android.intent.action.VIEW" />
    <category android:name="android.intent.category.DEFAULT" />
    <category android:name="android.intent.category.BROWSABLE" />
    <data android:host="kakaolink"
        android:scheme="kakao${kakaoApiKey}" />
</intent-filter>
```
Uri Scheme이 kakao{나의 앱 key}://kakaolink 로 시작하는 링크는 우리 앱의 딥링크로 확인한다는 의미입니다.  
  
예를 들면 나의 앱 key가 123123이면
kakao123123://kakaolink/~~~~~ 이런식으로 시작하는 Uri는 우리 앱을 실행시키는 것 이지요.  
  
사실 android native를 개발했더라면, activity 하나하나마다 다른 host로 intent-filter를 설정헤줬어야 했을텐데, flutter를 사용한 덕에 하나의 activity만 사용하게 되었고, 반복적으로 deeplink를 위한 intent-filter를 만들어주지 않아도 되게 되었어요.(물론 여러개라면 중간에 후킹하는 activity를 만들었겠지만요..) 


이 코드를 추가하면서 생각한 건, 단순 url을 열어주는 공유기능으로 생각했던 게 사실은 아닐지도 모르겠다는 생각이었어요.  
  
그리고, 카카오톡 공유 flutter sdk 공식 문서에는 없던 이 한 줄의 코드를 발견하게 됩니다..  
```dart
kakaoSchemeStream.listen((url) {
    // url에 커스텀 URL 스킴이 할당됩니다. 할당된 스킴의 활용 코드를 작성합니다.
}, onError: (e) {
    // 에러 상황의 예외 처리 코드를 작성합니다.
});
```
그리고 이해가 안되던 이 사진을 비로소 이해할 수 있게 되었죠..  
  
  
<img src=https://developers.kakao.com/docs/latest/ko/assets/style/images/message/message_template_link.png>
  
  
결국 카카오톡 공유는 딥 링크였고, firebase dynamic link를 추가로 채용할 필요가 없었다..!  
사실 이 사실을 알기 전 까지는 Dynamic link를 이용하여 Uri link를 만들었고, 해당 링크를 kakaotalk 공유로 넣었었다..  
어쩐지 느리더라..  

.
.
